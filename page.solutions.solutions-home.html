{% assign category_list_enabled = true %}
{% assign category_tree_enabled = false %}
{% assign recent_articles_enabled = true %}

<div class="solutions-home-page">
  <div class="row clearfix">
    <div class="column column--sm-8">
      <ol class="breadcrumbs">
        <li>
          <a href="/support/home">{{portal.name}}</a>
        </li>
        <li title="{% translate portal.solutions_home %}">
          {% translate portal.solutions_home %}
        </li>
      </ol>
    </div>
    <div class="column column--sm-4">
      <div class="search-box search-box--small">
        {% snippet search_form %}
      </div>
    </div>
  </div>

  {% if category_list_enabled %}
    <h1 class="knowledge-base-title">{% translate portal.knowledge_base %}</h1>
    <ul class="row category-list clearfix" id="category-list">
      {% for category in portal.solution_categories %}
        {% if category.folders_count > 0 %}
          <li class="column column--sm-4 category-list-item">
            <a class="category-list-item__link" href="{{category.url}}">
              <h2 class="h5 category-list-item__title">{{category.name}}</h2>
            </a>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  {% endif %}

  {% if category_tree_enabled %}
    <div class="category-tree" id="category-tree">
      {% for category in portal.solution_categories %}
        {% if category.folders_count > 0 %}
          <section class="category-tree-item">
            <h2 class="category-tree-item__title">
              <a class="category-tree-item__title-link" href="{{category.url}}">{{category.name}}</a>
            </h2>
            <div class="category-tree-item__folders row clearfix">
              {% for folder in category.folders %}
                {% if folder.articles_count > 0 %}
                  <section class="column column--sm-6 column--md-4 folder">
                    <h3 class="folder__title">
                      <a class="folder__title-link" href="{{folder.url}}">{{folder.name}}</a>
                    </h3>
                    <ul class="articles">
                      {% for article in folder.articles | limit: 5 %}
                        <li class="articles__item">
                          <a class="articles__link" href="{{article.url}}">{{article.title | h}}</a>
                        </li>
                      {% endfor %}
                    </ul>
                    {% if folder.articles.size > 5 %}
                      <a href="{{folder.url}}" class="btn btn-default see-all-articles">
                        View all ({{folder.articles_count}})
                      </a>
                    {% endif %}
                  </section>
                {% endif %}
              {% else %}
                {{portal | filler_for_solutions}}
              {% endfor %}
            </div>
          </section>
        {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  {% if recent_articles_enabled %}
    {% if portal.recent_articles.size > 0 %}
      <div class="recent-articles" id="recent-articles">
        <h3 class="recent-articles__title">Recent articles</h3>
        <ul class="row recent-articles__list">
          {% for article in portal.recent_articles limit:6 %}
            <li class="column column--sm-4 recent-articles-item">
              <a class="recent-articles-item__title" href="{{article.url}}">{{article.title | h}}</a>
              {% if article.body_plain != blank %}
                <p class="recent-articles-item__excerpt meta">
                  {{article.body_plain | h || truncate:80}}
                </p>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  {% endif %}
</div>
